<!DOCTYPE html>
<html lang="en">
<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title> Dependency Inversion Visualization</title>
		<script src="https://cdn.tailwindcss.com"></script>
		<style>
		.tooltip {
      position: absolute;
      background-color: #f9f9f9;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      display: none;
    }
		</style>
</head>
<body>
<div class="h-screen flex flex-col lg:flex-row bg-gray-900">
	<div class="lg:w-1/3 p-4 flex flex-col h-full border-r border-gray-700">
		<h2 class="text-2xl font-bold mb-4 text-green-400">Graph Exploration Tool</h2>
		<div class="flex-1 overflow-auto">
			<h3 class="text-xl font-semibold mb-2 text-blue-400">Node Controls</h3>
			<button class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 w-full mb-2 text-gray-300 border-gray-500">
				Focus Node
			</button>
			<div class="mb-2">
				<h4 class="text-lg font-semibold mb-2 text-yellow-500">Filter Nodes</h4>
				<button
					type="button"
					role="combobox"
					aria-controls="radix-:R4sulllla:"
					aria-expanded="false"
					aria-autocomplete="none"
					dir="ltr"
					data-state="closed"
					data-placeholder=""
					class="flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
				>
					<span style="pointer-events:none">Select nodes</span>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="24"
						height="24"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						class="h-4 w-4 opacity-50"
						aria-hidden="true"
					>
						<path d="m6 9 6 6 6-6"></path>
					</svg>
				</button>
			</div>
			<h3 class="text-xl font-semibold mb-2 text-blue-400">Graph Roots</h3>
			<div class="mb-2">
				<button
					type="button"
					role="combobox"
					aria-controls="radix-:R3culllla:"
					aria-expanded="false"
					aria-autocomplete="none"
					dir="ltr"
					data-state="closed"
					data-placeholder=""
					class="flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
				>
					<span style="pointer-events:none">Select a root</span>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="24"
						height="24"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						class="h-4 w-4 opacity-50"
						aria-hidden="true"
					>
						<path d="m6 9 6 6 6-6"></path>
					</svg>
				</button>
				<button class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 w-full mt-2 text-gray-300 border-gray-500">
					Show All Roots
				</button>
			</div>
		</div>
		<div class="mt-4">
			<h3 class="text-xl font-semibold mb-2 text-blue-400">Search</h3>
			<div class="relative">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="24"
					height="24"
					viewBox="0 0 24 24"
					fill="none"
					stroke="currentColor"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
					class=" absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"
				>
					<circle cx="11" cy="11" r="8"></circle>
					<path d="m21 21-4.3-4.3"></path>
				</svg>
				<input
					type="search"
					class="flex h-10 rounded-md px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 w-full appearance-none pl-8 text-gray-300 bg-gray-800 border border-gray-700"
					placeholder="Search nodes or edges..."
				/>
			</div>
		</div>
	</div>
	<div class="flex-1 p-4 relative bg-gray-800">
		<h3 class="text-xl font-semibold mb-2 text-blue-400">Graph Visualization</h3>
		<div class="w-full h-full rounded-lg border border-gray-700 border-dashed" id="holder">
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.7.5/joint.css" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.4.1/backbone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.7.5/joint.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/elkjs@0.8.2/lib/elk.bundled.min.js "></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.7.7/vectorizer.min.js"></script>
		<script src="https://cdn.rawgit.com/ariutta/svg-pan-zoom/master/dist/svg-pan-zoom.min.js"></script>

		<script>
	var MD5 = function(d){var r = M(V(Y(X(d),8*d.length)));return r.toLowerCase()};function M(d){for(var _,m="0123456789ABCDEF",f="",r=0;r<d.length;r++)_=d.charCodeAt(r),f+=m.charAt(_>>>4&15)+m.charAt(15&_);return f}function X(d){for(var _=Array(d.length>>2),m=0;m<_.length;m++)_[m]=0;for(m=0;m<8*d.length;m+=8)_[m>>5]|=(255&d.charCodeAt(m/8))<<m%32;return _}function V(d){for(var _="",m=0;m<32*d.length;m+=8)_+=String.fromCharCode(d[m>>5]>>>m%32&255);return _}function Y(d,_){d[_>>5]|=128<<_%32,d[14+(_+64>>>9<<4)]=_;for(var m=1732584193,f=-271733879,r=-1732584194,i=271733878,n=0;n<d.length;n+=16){var h=m,t=f,g=r,e=i;f=md5_ii(f=md5_ii(f=md5_ii(f=md5_ii(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_ff(f=md5_ff(f=md5_ff(f=md5_ff(f,r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+0],7,-680876936),f,r,d[n+1],12,-389564586),m,f,d[n+2],17,606105819),i,m,d[n+3],22,-1044525330),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+4],7,-176418897),f,r,d[n+5],12,1200080426),m,f,d[n+6],17,-1473231341),i,m,d[n+7],22,-45705983),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+8],7,1770035416),f,r,d[n+9],12,-1958414417),m,f,d[n+10],17,-42063),i,m,d[n+11],22,-1990404162),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+12],7,1804603682),f,r,d[n+13],12,-40341101),m,f,d[n+14],17,-1502002290),i,m,d[n+15],22,1236535329),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+1],5,-165796510),f,r,d[n+6],9,-1069501632),m,f,d[n+11],14,643717713),i,m,d[n+0],20,-373897302),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+5],5,-701558691),f,r,d[n+10],9,38016083),m,f,d[n+15],14,-660478335),i,m,d[n+4],20,-405537848),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+9],5,568446438),f,r,d[n+14],9,-1019803690),m,f,d[n+3],14,-187363961),i,m,d[n+8],20,1163531501),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+13],5,-1444681467),f,r,d[n+2],9,-51403784),m,f,d[n+7],14,1735328473),i,m,d[n+12],20,-1926607734),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+5],4,-378558),f,r,d[n+8],11,-2022574463),m,f,d[n+11],16,1839030562),i,m,d[n+14],23,-35309556),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+1],4,-1530992060),f,r,d[n+4],11,1272893353),m,f,d[n+7],16,-155497632),i,m,d[n+10],23,-1094730640),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+13],4,681279174),f,r,d[n+0],11,-358537222),m,f,d[n+3],16,-722521979),i,m,d[n+6],23,76029189),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+9],4,-640364487),f,r,d[n+12],11,-421815835),m,f,d[n+15],16,530742520),i,m,d[n+2],23,-995338651),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+0],6,-198630844),f,r,d[n+7],10,1126891415),m,f,d[n+14],15,-1416354905),i,m,d[n+5],21,-57434055),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+12],6,1700485571),f,r,d[n+3],10,-1894986606),m,f,d[n+10],15,-1051523),i,m,d[n+1],21,-2054922799),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+8],6,1873313359),f,r,d[n+15],10,-30611744),m,f,d[n+6],15,-1560198380),i,m,d[n+13],21,1309151649),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+4],6,-145523070),f,r,d[n+11],10,-1120210379),m,f,d[n+2],15,718787259),i,m,d[n+9],21,-343485551),m=safe_add(m,h),f=safe_add(f,t),r=safe_add(r,g),i=safe_add(i,e)}return Array(m,f,r,i)}function md5_cmn(d,_,m,f,r,i){return safe_add(bit_rol(safe_add(safe_add(_,d),safe_add(f,i)),r),m)}function md5_ff(d,_,m,f,r,i,n){return md5_cmn(_&m|~_&f,d,_,r,i,n)}function md5_gg(d,_,m,f,r,i,n){return md5_cmn(_&f|m&~f,d,_,r,i,n)}function md5_hh(d,_,m,f,r,i,n){return md5_cmn(_^m^f,d,_,r,i,n)}function md5_ii(d,_,m,f,r,i,n){return md5_cmn(m^(_|~f),d,_,r,i,n)}function safe_add(d,_){var m=(65535&d)+(65535&_);return(d>>16)+(_>>16)+(m>>16)<<16|65535&m}function bit_rol(d,_){return d<<_|d>>>32-_}

const graphData = {"name":"","deps":[{"name":"SchemaServer","deps":[{"name":"serverschema.New","deps":[{"name":"","deps":[{"name":"Host","deps":[{"name":"cfg.RabbitMQ.Host","value":"node-1.rabbitmq-1.dc-2.ac.dcwp.pl"}]},{"name":"User","deps":[{"name":"cfg.RabbitMQ.User","value":"FILL USING ENVS"}]},{"name":"Pass","deps":[{"name":"cfg.RabbitMQ.Password","value":"cfg.RabbitMQ.Password (error: var error: object has no member \"Password\")"}]},{"name":"VHost","deps":[{"name":"cfg.RabbitMQ.VHost","value":"CDP"}]},{"name":"QueueName","deps":[{"name":"\"deleteAttributeValues\""}]},{"name":"DlqName","deps":[{"name":"\"deleteAttributeValuesDLQ\""}]},{"name":"ContentType","deps":[{"name":"\"application/json\""}]},{"name":"ThrottleOutput","deps":[{"name":"cfg.Flags.ThrottleOutput","value":false}]}]},{"name":"measured.NewSchemaRepo","deps":[{"name":"schemaWriterDecorator.NewSchemaRepo","deps":[{"name":"mongoschemarepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.SchemaRepo.DBName","value":"cdp"},{"name":"cfg.SchemaRepo.CollectionName","value":"schemas"}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SchemaChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SchemaChangeKafka.Topic","value":"cdp-schema-change-wpm-prod"}]}]}]},{"name":"composite.New","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"elasticDPRepo","deps":[{"name":"elasticpkg.ElasticsearchClient"},{"name":"measuredtranslator.NewTranslator","deps":[{"name":"elastictranslator.NewTranslatorWithFetcher","deps":[{"name":"dp.NewValueParserImpl"},{"name":"mongo2.NewFetcher","deps":[{"name":"mongo.NewCdpIDStatsRepo","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.CdpIDStatsRepo.DBName","value":"cdp"},{"name":"cfg.CdpIDStatsRepo.CollectionName","value":"cdp_id_stats"}]}]},{"name":"","deps":[{"name":"translator.EqualOp","deps":[{"name":"elastictranslator.GenerateEquals"}]},{"name":"translator.NotEqualOp","deps":[{"name":"elastictranslator.GenerateNotEquals"}]},{"name":"translator.GreaterThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOp"}]}]},{"name":"translator.GreaterThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOrEqualOp"}]}]},{"name":"translator.LessThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOp"}]}]},{"name":"translator.LessThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOrEqualOp"}]}]},{"name":"translator.ContainsOp","deps":[{"name":"elastictranslator.GenerateContains"}]},{"name":"translator.NotContainsOp","deps":[{"name":"elastictranslator.GenerateNotContains"}]}]},{"name":"","deps":[{"name":"translator.FQLTranslator","deps":[{"name":"fql.NewFactory"}]}]}]}]}]},{"name":"elasticDPRepo","deps":[{"name":"elasticpkg.ElasticsearchClient"},{"name":"measuredtranslator.NewTranslator","deps":[{"name":"elastictranslator.NewTranslatorWithFetcher","deps":[{"name":"dp.NewValueParserImpl"},{"name":"mongo2.NewFetcher","deps":[{"name":"mongo.NewCdpIDStatsRepo","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.CdpIDStatsRepo.DBName","value":"cdp"},{"name":"cfg.CdpIDStatsRepo.CollectionName","value":"cdp_id_stats"}]}]},{"name":"","deps":[{"name":"translator.EqualOp","deps":[{"name":"elastictranslator.GenerateEquals"}]},{"name":"translator.NotEqualOp","deps":[{"name":"elastictranslator.GenerateNotEquals"}]},{"name":"translator.GreaterThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOp"}]}]},{"name":"translator.GreaterThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOrEqualOp"}]}]},{"name":"translator.LessThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOp"}]}]},{"name":"translator.LessThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOrEqualOp"}]}]},{"name":"translator.ContainsOp","deps":[{"name":"elastictranslator.GenerateContains"}]},{"name":"translator.NotContainsOp","deps":[{"name":"elastictranslator.GenerateNotContains"}]}]},{"name":"","deps":[{"name":"translator.FQLTranslator","deps":[{"name":"fql.NewFactory"}]}]}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]}]},{"name":"measured.NewDpRepoApplyChanges","deps":[{"name":"saramaRepo.NewDpRepoApplyChanges","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"measured.New","deps":[{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.AttrChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.AttrChangeKafka.Topic","value":"cdp-digital-profile-change-wpm-prod"}]}]}]}]},{"name":"measured.NewRecipeRepo","deps":[{"name":"mongoreciperepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.RecipeRepo.DBName","value":"cdp"},{"name":"cfg.RecipeRepo.CollectionName","value":"recipes"}]},{"name":"mongoreciperepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.RecipeRepo.DBName","value":"cdp"},{"name":"cfg.RecipeRepo.CollectionName","value":"recipes"}]}]},{"name":"measured.NewSegmentRepo","deps":[{"name":"mongosegmentrepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.SegmentRepo.DBName","value":"cdp"},{"name":"cfg.SegmentRepo.CollectionName","value":"segments"}]}]},{"name":"defaults.IdentifierAttributes"},{"name":"defaults.SystemAttributes"},{"name":"\"firstName\""},{"name":"\"lastName\""},{"name":"\"email\""},{"name":"\"phoneNumber\""},{"name":"\"pageVisits\""},{"name":"\"purchaseCount\""},{"name":"\"clientLifetimeValue\""},{"name":"\"shopVisitCount\""},{"name":"\"country\""},{"name":"\"deviceType\""},{"name":"\"gender\""},{"name":"\"birthDate\""},{"name":"\"createdAt\""},{"name":"\"holdingAgreement\""},{"name":"\"age\""},{"name":"defaults.MaxCapacity"}]}]},{"name":"DPServer","deps":[{"name":"serverdp.New","deps":[{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]},{"name":"typedprofilefactory.New","deps":[{"name":"\"firstName\""},{"name":"\"lastName\""},{"name":"\"email\""},{"name":"\"phoneNumber\""},{"name":"\"pageVisits\""},{"name":"\"purchaseCount\""},{"name":"\"clientLifetimeValue\""},{"name":"\"shopVisitCount\""},{"name":"\"country\""},{"name":"\"deviceType\""},{"name":"\"gender\""},{"name":"\"birthDate\""},{"name":"\"createdAt\""},{"name":"\"holdingAgreement\""},{"name":"\"age\""}]},{"name":"composite.New","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"elasticDPRepo","deps":[{"name":"elasticpkg.ElasticsearchClient"},{"name":"measuredtranslator.NewTranslator","deps":[{"name":"elastictranslator.NewTranslatorWithFetcher","deps":[{"name":"dp.NewValueParserImpl"},{"name":"mongo2.NewFetcher","deps":[{"name":"mongo.NewCdpIDStatsRepo","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.CdpIDStatsRepo.DBName","value":"cdp"},{"name":"cfg.CdpIDStatsRepo.CollectionName","value":"cdp_id_stats"}]}]},{"name":"","deps":[{"name":"translator.EqualOp","deps":[{"name":"elastictranslator.GenerateEquals"}]},{"name":"translator.NotEqualOp","deps":[{"name":"elastictranslator.GenerateNotEquals"}]},{"name":"translator.GreaterThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOp"}]}]},{"name":"translator.GreaterThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOrEqualOp"}]}]},{"name":"translator.LessThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOp"}]}]},{"name":"translator.LessThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOrEqualOp"}]}]},{"name":"translator.ContainsOp","deps":[{"name":"elastictranslator.GenerateContains"}]},{"name":"translator.NotContainsOp","deps":[{"name":"elastictranslator.GenerateNotContains"}]}]},{"name":"","deps":[{"name":"translator.FQLTranslator","deps":[{"name":"fql.NewFactory"}]}]}]}]}]},{"name":"elasticDPRepo","deps":[{"name":"elasticpkg.ElasticsearchClient"},{"name":"measuredtranslator.NewTranslator","deps":[{"name":"elastictranslator.NewTranslatorWithFetcher","deps":[{"name":"dp.NewValueParserImpl"},{"name":"mongo2.NewFetcher","deps":[{"name":"mongo.NewCdpIDStatsRepo","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.CdpIDStatsRepo.DBName","value":"cdp"},{"name":"cfg.CdpIDStatsRepo.CollectionName","value":"cdp_id_stats"}]}]},{"name":"","deps":[{"name":"translator.EqualOp","deps":[{"name":"elastictranslator.GenerateEquals"}]},{"name":"translator.NotEqualOp","deps":[{"name":"elastictranslator.GenerateNotEquals"}]},{"name":"translator.GreaterThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOp"}]}]},{"name":"translator.GreaterThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOrEqualOp"}]}]},{"name":"translator.LessThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOp"}]}]},{"name":"translator.LessThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOrEqualOp"}]}]},{"name":"translator.ContainsOp","deps":[{"name":"elastictranslator.GenerateContains"}]},{"name":"translator.NotContainsOp","deps":[{"name":"elastictranslator.GenerateNotContains"}]}]},{"name":"","deps":[{"name":"translator.FQLTranslator","deps":[{"name":"fql.NewFactory"}]}]}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]}]},{"name":"saramaRepo.NewDpRepoApplyChanges","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"measured.New","deps":[{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.AttrChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.AttrChangeKafka.Topic","value":"cdp-digital-profile-change-wpm-prod"}]}]}]},{"name":"measured.NewSchemaRepo","deps":[{"name":"schemaWriterDecorator.NewSchemaRepo","deps":[{"name":"mongoschemarepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.SchemaRepo.DBName","value":"cdp"},{"name":"cfg.SchemaRepo.CollectionName","value":"schemas"}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SchemaChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SchemaChangeKafka.Topic","value":"cdp-schema-change-wpm-prod"}]}]}]},{"name":"validator.New","deps":[{"name":"singleValidator","deps":[{"name":"validators.New","deps":[{"name":"validators.ValidateMaxCapacity"},{"name":"validators.ValidateValueType"},{"name":"validators.ValidateAttributeType"},{"name":"validators.ValidateOperator"}]}]},{"name":"\"firstName\""},{"name":"\"lastName\""},{"name":"\"email\""},{"name":"\"phoneNumber\""},{"name":"\"pageVisits\""},{"name":"\"purchaseCount\""},{"name":"\"clientLifetimeValue\""},{"name":"\"shopVisitCount\""},{"name":"\"country\""},{"name":"\"deviceType\""},{"name":"\"gender\""},{"name":"\"birthDate\""},{"name":"\"createdAt\""},{"name":"\"holdingAgreement\""},{"name":"\"age\""},{"name":"defaults.SystemAttributes"}]},{"name":"serverdp.NewAdapter","deps":[{"name":"typedprofilefactory.New","deps":[{"name":"\"firstName\""},{"name":"\"lastName\""},{"name":"\"email\""},{"name":"\"phoneNumber\""},{"name":"\"pageVisits\""},{"name":"\"purchaseCount\""},{"name":"\"clientLifetimeValue\""},{"name":"\"shopVisitCount\""},{"name":"\"country\""},{"name":"\"deviceType\""},{"name":"\"gender\""},{"name":"\"birthDate\""},{"name":"\"createdAt\""},{"name":"\"holdingAgreement\""},{"name":"\"age\""}]}]},{"name":"\"firstName\""},{"name":"\"lastName\""},{"name":"\"email\""},{"name":"\"phoneNumber\""},{"name":"\"pageVisits\""},{"name":"\"purchaseCount\""},{"name":"\"clientLifetimeValue\""},{"name":"\"shopVisitCount\""},{"name":"\"country\""},{"name":"\"deviceType\""},{"name":"\"gender\""},{"name":"\"birthDate\""},{"name":"\"createdAt\""},{"name":"\"holdingAgreement\""},{"name":"\"age\""}]}]},{"name":"RecipeServer","deps":[{"name":"serverrecipe.New","deps":[{"name":"reciperepo.New","deps":[{"name":"file.NewRecipeRepo","deps":[{"name":"cfg.RecipeRepo.DotStaticDirectory","value":"assets/recipe/wpm"},{"name":"\"dot\""}]},{"name":"file.NewRecipeRepo","deps":[{"name":"cfg.RecipeRepo.PXStaticDirectory","value":"assets/recipe/ecommerce"},{"name":"\"px\""}]},{"name":"measured.NewRecipeRepo","deps":[{"name":"mongoreciperepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.RecipeRepo.DBName","value":"cdp"},{"name":"cfg.RecipeRepo.CollectionName","value":"recipes"}]},{"name":"mongoreciperepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.RecipeRepo.DBName","value":"cdp"},{"name":"cfg.RecipeRepo.CollectionName","value":"recipes"}]}]}]},{"name":"measured.NewRecipeRepo","deps":[{"name":"mongoreciperepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.RecipeRepo.DBName","value":"cdp"},{"name":"cfg.RecipeRepo.CollectionName","value":"recipes"}]},{"name":"mongoreciperepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.RecipeRepo.DBName","value":"cdp"},{"name":"cfg.RecipeRepo.CollectionName","value":"recipes"}]}]}]}]},{"name":"SegmentServer","deps":[{"name":"serversegment.New","deps":[{"name":"","deps":[{"name":"Host","deps":[{"name":"cfg.RabbitMQ.Host","value":"node-1.rabbitmq-1.dc-2.ac.dcwp.pl"}]},{"name":"User","deps":[{"name":"cfg.RabbitMQ.User","value":"FILL USING ENVS"}]},{"name":"Pass","deps":[{"name":"cfg.RabbitMQ.Password","value":"cfg.RabbitMQ.Password (error: var error: object has no member \"Password\")"}]},{"name":"VHost","deps":[{"name":"cfg.RabbitMQ.VHost","value":"CDP"}]},{"name":"QueueName","deps":[{"name":"\"removeFromSegment\""}]},{"name":"DlqName","deps":[{"name":"\"removeFromSegmentDLQ\""}]},{"name":"ContentType","deps":[{"name":"\"text/plain\""}]},{"name":"ThrottleOutput","deps":[{"name":"cfg.Flags.ThrottleOutput","value":false}]}]},{"name":"measured.NewSegmentRepo","deps":[{"name":"mongosegmentrepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.SegmentRepo.DBName","value":"cdp"},{"name":"cfg.SegmentRepo.CollectionName","value":"segments"}]}]},{"name":"measured.NewSegmentCreationRepo","deps":[{"name":"writerdecorator.NewSegmentCreationRepo","deps":[{"name":"mongosegmentrepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.SegmentRepo.DBName","value":"cdp"},{"name":"cfg.SegmentRepo.CollectionName","value":"segments"}]},{"name":"","deps":[{"name":"Host","deps":[{"name":"cfg.RabbitMQ.Host","value":"node-1.rabbitmq-1.dc-2.ac.dcwp.pl"}]},{"name":"User","deps":[{"name":"cfg.RabbitMQ.User","value":"FILL USING ENVS"}]},{"name":"Pass","deps":[{"name":"cfg.RabbitMQ.Password","value":"cfg.RabbitMQ.Password (error: var error: object has no member \"Password\")"}]},{"name":"VHost","deps":[{"name":"cfg.RabbitMQ.VHost","value":"CDP"}]},{"name":"QueueName","deps":[{"name":"\"segmentCreation\""}]},{"name":"DlqName","deps":[{"name":"\"segmentCreationDLQ\""}]},{"name":"ContentType","deps":[{"name":"\"text/plain\""}]},{"name":"ThrottleOutput","deps":[{"name":"cfg.Flags.ThrottleOutput","value":false}]}]}]}]},{"name":"composite.New","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"elasticDPRepo","deps":[{"name":"elasticpkg.ElasticsearchClient"},{"name":"measuredtranslator.NewTranslator","deps":[{"name":"elastictranslator.NewTranslatorWithFetcher","deps":[{"name":"dp.NewValueParserImpl"},{"name":"mongo2.NewFetcher","deps":[{"name":"mongo.NewCdpIDStatsRepo","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.CdpIDStatsRepo.DBName","value":"cdp"},{"name":"cfg.CdpIDStatsRepo.CollectionName","value":"cdp_id_stats"}]}]},{"name":"","deps":[{"name":"translator.EqualOp","deps":[{"name":"elastictranslator.GenerateEquals"}]},{"name":"translator.NotEqualOp","deps":[{"name":"elastictranslator.GenerateNotEquals"}]},{"name":"translator.GreaterThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOp"}]}]},{"name":"translator.GreaterThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOrEqualOp"}]}]},{"name":"translator.LessThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOp"}]}]},{"name":"translator.LessThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOrEqualOp"}]}]},{"name":"translator.ContainsOp","deps":[{"name":"elastictranslator.GenerateContains"}]},{"name":"translator.NotContainsOp","deps":[{"name":"elastictranslator.GenerateNotContains"}]}]},{"name":"","deps":[{"name":"translator.FQLTranslator","deps":[{"name":"fql.NewFactory"}]}]}]}]}]},{"name":"elasticDPRepo","deps":[{"name":"elasticpkg.ElasticsearchClient"},{"name":"measuredtranslator.NewTranslator","deps":[{"name":"elastictranslator.NewTranslatorWithFetcher","deps":[{"name":"dp.NewValueParserImpl"},{"name":"mongo2.NewFetcher","deps":[{"name":"mongo.NewCdpIDStatsRepo","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.CdpIDStatsRepo.DBName","value":"cdp"},{"name":"cfg.CdpIDStatsRepo.CollectionName","value":"cdp_id_stats"}]}]},{"name":"","deps":[{"name":"translator.EqualOp","deps":[{"name":"elastictranslator.GenerateEquals"}]},{"name":"translator.NotEqualOp","deps":[{"name":"elastictranslator.GenerateNotEquals"}]},{"name":"translator.GreaterThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOp"}]}]},{"name":"translator.GreaterThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOrEqualOp"}]}]},{"name":"translator.LessThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOp"}]}]},{"name":"translator.LessThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOrEqualOp"}]}]},{"name":"translator.ContainsOp","deps":[{"name":"elastictranslator.GenerateContains"}]},{"name":"translator.NotContainsOp","deps":[{"name":"elastictranslator.GenerateNotContains"}]}]},{"name":"","deps":[{"name":"translator.FQLTranslator","deps":[{"name":"fql.NewFactory"}]}]}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]}]},{"name":"measured.NewRecipeRepo","deps":[{"name":"mongoreciperepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.RecipeRepo.DBName","value":"cdp"},{"name":"cfg.RecipeRepo.CollectionName","value":"recipes"}]},{"name":"mongoreciperepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.RecipeRepo.DBName","value":"cdp"},{"name":"cfg.RecipeRepo.CollectionName","value":"recipes"}]}]}]}]},{"name":"SchemaRepo","deps":[{"name":"measured.NewSchemaRepo","deps":[{"name":"schemaWriterDecorator.NewSchemaRepo","deps":[{"name":"mongoschemarepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.SchemaRepo.DBName","value":"cdp"},{"name":"cfg.SchemaRepo.CollectionName","value":"schemas"}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SchemaChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SchemaChangeKafka.Topic","value":"cdp-schema-change-wpm-prod"}]}]}]}]},{"name":"DPRepo","deps":[{"name":"composite.New","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"elasticDPRepo","deps":[{"name":"elasticpkg.ElasticsearchClient"},{"name":"measuredtranslator.NewTranslator","deps":[{"name":"elastictranslator.NewTranslatorWithFetcher","deps":[{"name":"dp.NewValueParserImpl"},{"name":"mongo2.NewFetcher","deps":[{"name":"mongo.NewCdpIDStatsRepo","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.CdpIDStatsRepo.DBName","value":"cdp"},{"name":"cfg.CdpIDStatsRepo.CollectionName","value":"cdp_id_stats"}]}]},{"name":"","deps":[{"name":"translator.EqualOp","deps":[{"name":"elastictranslator.GenerateEquals"}]},{"name":"translator.NotEqualOp","deps":[{"name":"elastictranslator.GenerateNotEquals"}]},{"name":"translator.GreaterThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOp"}]}]},{"name":"translator.GreaterThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOrEqualOp"}]}]},{"name":"translator.LessThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOp"}]}]},{"name":"translator.LessThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOrEqualOp"}]}]},{"name":"translator.ContainsOp","deps":[{"name":"elastictranslator.GenerateContains"}]},{"name":"translator.NotContainsOp","deps":[{"name":"elastictranslator.GenerateNotContains"}]}]},{"name":"","deps":[{"name":"translator.FQLTranslator","deps":[{"name":"fql.NewFactory"}]}]}]}]}]},{"name":"elasticDPRepo","deps":[{"name":"elasticpkg.ElasticsearchClient"},{"name":"measuredtranslator.NewTranslator","deps":[{"name":"elastictranslator.NewTranslatorWithFetcher","deps":[{"name":"dp.NewValueParserImpl"},{"name":"mongo2.NewFetcher","deps":[{"name":"mongo.NewCdpIDStatsRepo","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.CdpIDStatsRepo.DBName","value":"cdp"},{"name":"cfg.CdpIDStatsRepo.CollectionName","value":"cdp_id_stats"}]}]},{"name":"","deps":[{"name":"translator.EqualOp","deps":[{"name":"elastictranslator.GenerateEquals"}]},{"name":"translator.NotEqualOp","deps":[{"name":"elastictranslator.GenerateNotEquals"}]},{"name":"translator.GreaterThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOp"}]}]},{"name":"translator.GreaterThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.GreaterThanOrEqualOp"}]}]},{"name":"translator.LessThanOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOp"}]}]},{"name":"translator.LessThanOrEqualOp","deps":[{"name":"elastictranslator.GenerateRange","deps":[{"name":"translator.LessThanOrEqualOp"}]}]},{"name":"translator.ContainsOp","deps":[{"name":"elastictranslator.GenerateContains"}]},{"name":"translator.NotContainsOp","deps":[{"name":"elastictranslator.GenerateNotContains"}]}]},{"name":"","deps":[{"name":"translator.FQLTranslator","deps":[{"name":"fql.NewFactory"}]}]}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"segmentRepoChange","deps":[{"name":"writerdecorator.NewSegmentChange","deps":[{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"saramaWriter.NewWriter","deps":[{"name":"cfg.SegmentChangeKafka.Brokers","value":["kafka-1.dc-2.ac.dcwp.pl:9092","kafka-2.dc-2.ac.dcwp.pl:9092","kafka-3.dc-2.ac.dcwp.pl:9092","kafka-4.dc-2.ac.dcwp.pl:9092","kafka-5.dc-2.ac.dcwp.pl:9092","kafka-6.dc-2.ac.dcwp.pl:9092","kafka-7.dc-2.ac.dcwp.pl:9092","kafka-8.dc-2.ac.dcwp.pl:9092"]},{"name":"cfg.SegmentChangeKafka.Topic","value":"cdp-segment-change-wpm-prod"}]}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]},{"name":"mongodprepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.DigitalProfileRepo.DBName","value":"cdp"},{"name":"cfg.DigitalProfileRepo.CollectionName","value":"digital_profiles"},{"name":"model.NewDigitalProfileFactory","deps":[{"name":"acidregistry.NewClient","deps":[{"name":"cfg.ACIDRegistry.Host","value":""},{"name":"cfg.ACIDRegistry.APIKey","value":"cfg.ACIDRegistry.APIKey (error: var error: object has no member \"APIKey\")"}]},{"name":"time.Now"}]}]}]}]},{"name":"SegmentRepo","deps":[{"name":"measured.NewSegmentRepo","deps":[{"name":"mongosegmentrepo.New","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.SegmentRepo.DBName","value":"cdp"},{"name":"cfg.SegmentRepo.CollectionName","value":"segments"}]}]}]},{"name":"CdpIDStatsRepo","deps":[{"name":"mongo.NewCdpIDStatsRepo","deps":[{"name":"mongopkg.NewClient"},{"name":"cfg.CdpIDStatsRepo.DBName","value":"cdp"},{"name":"cfg.CdpIDStatsRepo.CollectionName","value":"cdp_id_stats"}]}]},{"name":"Factory","deps":[{"name":"typedprofilefactory.New","deps":[{"name":"\"firstName\""},{"name":"\"lastName\""},{"name":"\"email\""},{"name":"\"phoneNumber\""},{"name":"\"pageVisits\""},{"name":"\"purchaseCount\""},{"name":"\"clientLifetimeValue\""},{"name":"\"shopVisitCount\""},{"name":"\"country\""},{"name":"\"deviceType\""},{"name":"\"gender\""},{"name":"\"birthDate\""},{"name":"\"createdAt\""},{"name":"\"holdingAgreement\""},{"name":"\"age\""}]}]},{"name":"MongoClient","deps":[{"name":"mongopkg.NewClient"}]}]}
async function main(){
	let elements = [];

	let id = 0;

	function getTextDimensions(text, font) {
      // Create a temporary canvas
      var canvas = document.createElement('canvas');
      var context = canvas.getContext('2d');

      // Set the font on the context
      context.font = font;

			//split text into lines and get the longest one
			let lines = text.split("\n");
			let longestLine = "";
			for(let i = 0; i < lines.length; i++){
				if(lines[i].length > longestLine.length){
					longestLine = lines[i];
				}
			}
      var width = context.measureText(longestLine).width;
				

      // Get the font metrics
      var metrics = context.measureText(text);
      var height = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;

      // Return the dimensions
      return { width: width, height: height };
    }


	function fillHashes(node){
		stringRep = JSON.stringify(node)
		md5 = MD5(stringRep)
		node.md5 = md5;
		if (node.deps) {
			node.deps.forEach(d => {
				fillHashes(d);
			});
		}
	}


	fillHashes(graphData)

	function fillSizes(node){
		const text = node.name + (node.value ? `\n(${node.value})` : '')
		// cut all lines so they are max 30 chars long
		const lines = text.split("\n");
		for(let i = 0; i < lines.length; i++){
			if(lines[i].length > 30){
				lines[i] = lines[i].substring(0, 30) + "...";
			}
		}
		cut = lines.join("\n");
		const {width, height} = getTextDimensions(cut, '14px DejaVu Sans');
		node.width = width + 20;
		node.height = height + 20;
		node.label = cut
		node.tooltip = text
		if (node.deps) {
			node.deps.forEach(d => {
				fillSizes(d);
			});
		}
	}

	fillSizes(graphData)

	seen = {}
	id2node = {}
	var graph = new joint.dia.Graph({}, { cellNamespace: namespace });

	const elk = new ELK();

	var g = {
		id: "root",
		layoutOptions: { 
			'elk.algorithm': 'layered',
			'elk.direction': 'DOWN',
		},
		children: [],
		edges: [],
	}

	function processDependency(dep, parentID=null) {
		seenNode = seen[dep.md5];
		if (seenNode) {
			if (parentID) {
				parent = id2node[parentID];
				if (parent) {
					g.edges.push({ id: `${id}`, sources: [ parent.id ], targets: [ seenNode.id ] })
				} else {
					console.log('no parent', parentID)
				}
			}
			return;
		}
		let myID = id;
		id++;

		dep.id = myID;
		seen[dep.md5] = dep;

		g.children.push({
			id: myID, 
			width: dep.width, 
			height: dep.height,
			label: dep.label,
			tooltip: dep.tooltip,
		})

		id2node[myID] = dep;

		if (parentID) {
			parent = id2node[parentID];
			if (parent) {
				g.edges.push({ id: `${id}`, sources: [ parentID ], targets: [ dep.id ] })
			} else {
				console.log('no parent', parentID)
			}
		}

		if (dep.deps) {
			dep.deps.forEach(d => {
				processDependency(d, myID);
			});
		}
	}

	processDependency(graphData);

	await elk.layout(g);

	function createJointGraph() {
		id2node = {}

		g.children.forEach(function(node) {
			rect = new joint.shapes.standard.Rectangle();
			id2node[node.id] = rect;
			rect.tooltip = node.tooltip;
			rect.resize(node.width, node.height);
			rect.position(node.x, node.y);
			rect.attr({
				body: {
					fill: '#051015',
				},
				label: {
					text: node.label,
					fill: '#d1d5db',
				}
			});
			rect.addTo(graph);
		});

		g.edges.forEach(function(e) {
			points = []
			if (e.sections) {
				e.sections.forEach(function(s) {
					points.push({ x: s.startPoint.x, y: s.startPoint.y });
					if (s.bendPoints)
						s.bendPoints.forEach(function(b) {
							points.push({ x: b.x, y: b.y });
						});
					points.push({ x: s.endPoint.x, y: s.endPoint.y });
				});
			}

			points.pop();

			link = new joint.shapes.standard.Link();
			const linkArgs =  {
				connectionPoint: {
					name: 'boundary',
					args: {
						sticky: true,
					}
				},
				anchor: {
					name: 'perpendicular',
					args: {
						padding: 10,
					}
				}
			}

			const target = id2node[e.targets[0]];

			link.source(id2node[e.sources[0]], linkArgs);
			link.target(target, linkArgs);
			link.vertices(points);
			link.attr('line/stroke', '#eab308');
			link.addTo(graph);
		});
	}

	createJointGraph();

	var namespace = joint.shapes;

	holder = document.getElementById('holder');

	var paper = new joint.dia.Paper({
		el: holder,
		model: graph,
		width: '100%',
		height: '100%',
		gridSize: 1,
		cellViewNamespace: namespace,
		//block dragging edges and nodes
		interactive: false
	});

  // Handle mousemove event for panning
  let isDragging = false;
  let dragStartX, dragStartY;

	panAndZoom = svgPanZoom("#v-2");

	//Enable pan when a blank area is click (held) on
	paper.on('blank:pointerdown', function (evt, x, y) {
		panAndZoom.enablePan();
	});

	//Disable pan when the mouse button is released
	paper.on('cell:pointerup blank:pointerup', function(cellView, event) {
		panAndZoom.disablePan();
	});
	paper.on('element:mouseenter', function(e) {
		var tooltip = $('#tooltip');
		tooltip.text(e.model.tooltip);
		tooltip.css({
			top: event.clientY + 10,
			left: event.clientX + 10,
			}).show();
	});

	// Hide tooltip on mouseout
	paper.on('element:mouseleave', function() {
		$('#tooltip').hide();
	});
}

main().catch(console.error);

</script>
		</div>
	</div>
</div>
<div id="tooltip" class="tooltip absolute bg-white p-2 border rounded shadow-md">AAAAAAAAAAAAA</div>

</body>
</html>
